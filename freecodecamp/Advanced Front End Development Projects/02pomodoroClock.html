<!DOCTYPE html>
<html>
<head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type"  name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0;"/>
  <title>HOPES</title>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <link href="https://fonts.googleapis.com/css?family=Pacifico" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
  <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
  <style type="text/css">
  </style>
</head>
<body>
  <div class="container-fluid">
    <div class="row">
      <div class="col-sm-offset-4 col-sm-4 text-center">
        <h1>Podomoro</h1>
        <h2 id='status'></h2>
        <div class="col-sm-6">
          <h3>Break Length</h3>
          <div class="col-sm-4">
            <button class="btn btn-default breakmin">-</button>
          </div>
          <div class="col-sm-4 breaktime">
            5
          </div>
          <div class="col-sm-4">
            <button class="btn btn-default breakplus">+</button>
          </div>
        </div>
        <div class="col-sm-6">
          <h3>Session Length</h3>
          <div class="col-sm-4">
            <button class="btn btn-default sessionmin">-</button>
          </div>
          <div class="col-sm-4 sessiontime">
            5
          </div>
          <div class="col-sm-4">
            <button class="btn btn-default sessionplus">+</button>
          </div>
        </div>        
        <button class="btn btn-default startsession">START SESSION</button>
        <div class="session">0</div>
      </div>
    </div>
  </div>
</body>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script type="text/javascript">
  var sessiontime;
  var recount;
  var counting = false;
  var status = "work";
  var start = false;

  function setVal(number, state) {
    var val = parseInt($("."+state).text()) + number;
    counting = false;
    if (val > 0)
      $("."+state).text(val);
    clearInterval(recount);
    start = false;
    counting = false;
    status = "work";
  }

  //function mengurangi waktu yang di label break
  $(".breakmin").click(function() {
    setVal(-1, "breaktime");  
  });

  //function menambah waktu yang di label break
  $(".breakplus").click(function() {
    setVal(1, "breaktime");
  });

  //function menambah waktu yang di label session
  $(".sessionplus").click(function() {
    setVal(1, "sessiontime");
  });

  //function mengurangi waktu yang di label session
  $(".sessionmin").click(function() {
    setVal(-1, "sessiontime");  
  });

  //start the countdown
  $(".startsession").click(function() {
    //set the start state to true or false, because it's starting
    start = !start;

    //if it is starting already, but button clicked again (state start to false), then it will pause
    if (!start) {
      clearInterval(recount); //reset the counter
      counting = true;  //set state that the counting is running
      lastCount = sessionTime;  //save the last stopped time to resume the countdown later
    }

    if (start) {
      if (!counting) {  //if previously not paused then continue from the start set sessiontime
        sessionTime = parseInt($(".sessiontime").text())*60;
        counting = false;
      }
      else sessionTime = lastCount; //resume from before

      $(".session").text(Math.floor(sessionTime/60) + ":" + sessionTime%60);
      sessionTime--;      
      recount = setInterval(sessionrunning, 1000);
    }
  });

  //time is decreasing
  function sessionrunning() {
    $(".session").text(Math.floor(sessionTime/60) + ":" + sessionTime%60);
    if (status == "work")
      $("#status").text("Work Time");
    else $("#status").text("Break Time");

    if (sessionTime > 0)
      sessionTime--;
    else if (status == "work") {      
      sessionTime = parseInt($(".breaktime").text())*60;
      status = "break";
    }
    else {
      $("#status").text("Work Time");
      sessionTime = parseInt($(".sessiontime").text())*60;
      status = "work";
    }
  };  
</script>
</html>